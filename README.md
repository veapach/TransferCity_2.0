# TransferBot
MiniGame in Telegram Bot 

**Запуск**
1. В консоле зайти в папку с проектом
2. `python -m venv .venv`
3. `.venv\Scripts\activate`
4. `pip install -r requirements.txt`
5. В корне проекта создать файл config.py, туда вписать
`TG_TOKEN = 'токен бота'`

Идея:
Бот с глобальным рейтингом.

## 1. **Основные Компоненты Экономики**

### 1.1. **Валюты**

- **Поинты (Points):** Внутренняя валюта, используемая для взаимодействия между игроками, получения наград и покупок внутри игры.
- **Рейтинговые очки (Rating Points):** Используются для определения места в глобальном рейтинге и получения бонусов.
- **Премиум-валюта (Premium Currency):** Валюта, покупаемая за реальные деньги, используемая для ускорения прогресса и приобретения эксклюзивных функций.

### 1.2. **Начальные Параметры**

- **Стартовые поинты:** 100 поинтов для нового игрока.
- **Стартовые рейтинговые очки:** 100 рейтинговых очков.

## 2. **Механики Игры и Балансные Формулы**

### 2.1. **Передача Поинтов**

- **Условия передачи:**
  - Минимальный перевод: 10 поинтов.
  - Максимальный перевод: 100 поинтов за раз.
  - Комиссия за перевод: 5% от суммы перевода (например, при передаче 50 поинтов комиссия составляет 2.5 поинта).

- **Формула обновления рейтинговых очков:**
  - При передаче `X` поинтов, отправитель получает `X / 10` рейтинговых очков.
  - **Пример:** Игрок 1 передал Игроку 2 50 поинтов → Игрок 1 получает 5 рейтинговых очков.

- **Формула расчета новых балансов:**
  - **Отправитель:** `Баланс = Баланс - X - Комиссия`
  - **Получатель:** `Баланс = Баланс + X`

### 2.2. **Глобальный Рейтинг**

- **Расчет рейтинга:**
  - Рейтинг основан на суммарных рейтинговых очках.
  - **Формула:** `Рейтинг = Рейтинговые очки + Дополнительные очки за активность и события`.

- **Обновление рейтинга:**
  - Ежедневно пересчитывается на основе рейтинговых очков всех игроков.

### 2.3. **Ежедневные Награды**

- **Формула награды:**
  - `Награда = Место в рейтинге * 5 поинтов`
  
- **Пример:**
  - Игрок на 10-м месте получает 50 поинтов.

- **Дополнительные бонусы:**
  - Ежедневные задания или квесты, выполнение которых дает дополнительные поинты или рейтинговые очки.

### 2.4. **Покупка и Продажа Рейтинговых Очков**

- **Покупка за поинты:**
  - **Формула:** `Рейтинговые очки = Поинты / 10`
  - **Пример:** 100 поинтов → 10 рейтинговых очков.

- **Продажа рейтинговых очков:**
  - Игроки могут обменивать рейтинговые очки обратно на поинты по формуле: `Поинты = Рейтинговые очки * 10`.
  - **Комиссия при продаже:** 10%.

### 2.5. **Реферальная Система**

- **Базовые бонусы:**
  - **За каждого приведенного игрока:** 1000 поинтов.
  - **Процент от ежедневных наград:** 10%.

- **Многоуровневая реферальная система (опционально):**
  - **2-й уровень:** 5% от ежедневных наград рефералов 1-го уровня.
  - **3-й уровень:** 2% от ежедневных наград рефералов 2-го уровня.

- **Формула расчета бонусов:**
  - **Базовый бонус:** `1000 поинтов + 10% от ежедневных наград реферала`.
  - **Пример:** Если приведенный игрок получает 50 поинтов ежедневно, пригласивший игрок получает дополнительно 5 поинтов ежедневно.

### 2.6. **Покупка Поинтов за Реальные Деньги**

- **Пакеты поинтов:**
  - 100 поинтов за 50 рублей.
  - 600 поинтов за 250 рублей (с бонусом 10% → 660 поинтов).
  - 1500 поинтов за 500 рублей (с бонусом 10% → 1650 поинтов).

- **Формула расчета бонуса:**
  - `Бонус = Поинты * 0.10`

## 3. **Монетизация**

### 3.1. **Продажа Внутренней Валюты (Поинты)**

- Реализуйте возможность покупки поинтов через платежные системы Telegram или сторонние сервисы.
- Предложите различные пакеты поинтов с бонусами для стимулирования больших покупок.

### 3.2. **Реклама**

- **Награды за просмотр рекламы:**
  - Предлагайте игрокам просматривать рекламные видео за дополнительные поинты (например, 20 поинтов за просмотр одного видео).
  
- **Интеграция баннерной рекламы:**
  - Размещайте баннеры в меню бота или на страницах с рейтингом.

### 3.3. **Премиум Подписка**

- **Преимущества подписки:**
  - Увеличенные ежедневные награды (например, место * 7 вместо * 5).
  - Сниженные комиссии при переводах (например, 3% вместо 5%).
  - Доступ к эксклюзивным событиям и турнирам.
  - Ежемесячное начисление премиум-очков.

- **Стоимость подписки:**
  - Ежемесячная: 300 рублей.
  - Годовая: 3000 рублей (со скидкой).

### 3.4. **Микротранзакции**

- **Эксклюзивные предметы:**
  - Скины для профиля, уникальные значки, эмодзи.
  
- **Ускорители прогресса:**
  - Бустеры, увеличивающие ежедневные награды на определенный процент на 24 часа за 100 поинтов.

### 3.5. **События с Входом за Плату**

- **Турниры:**
  - Вступительный взнос: 500 поинтов.
  - Призовой фонд: 2000 поинтов, распределяемый между первыми 10 игроками.
  
- **Специальные мероприятия:**
  - Ограниченные по времени квесты с уникальными наградами за участие и выполнение.

### 3.6. **Партнерские и Реферальные Программы**

- **Партнерские предложения:**
  - Специальные бонусы за привлечение новых пользователей через партнерские ссылки.

- **Бонусы за активность:**
  - Дополнительные поинты или рейтинговые очки за выполнение определенных действий внутри бота (например, ежедневный вход, участие в событиях).

## 4. **Примеры Балансных Формул и Значений**

### 4.1. **Ежедневные Награды**

- **Формула:** `Награда = Место в рейтинге * 5 поинтов`
- **Пример:**
  - 1 место: 5 поинтов
  - 100 место: 500 поинтов

### 4.2. **Рейтинг и Прогрессия**

- **Рейтинговые очки:** `Рейтинговые очки = Сумма (X / 10) за все переводы X поинтов`
- **Пример:** Игрок перевел 500 поинтов за все время → 50 рейтинговых очков.

### 4.3. **Комиссия за Переводы**

- **Формула:** `Комиссия = X * 0.05`
- **Пример:** Передача 50 поинтов → Комиссия = 2.5 поинта.

### 4.4. **Покупка Рейтинговых Очков**

- **Формула:** `Рейтинговые очки = Поинты / 10`
- **Пример:** 100 поинтов → 10 рейтинговых очков.

### 4.5. **Реферальные Бонусы**

- **Базовый бонус:** `1000 поинтов + 10% от ежедневных наград реферала`
- **Пример:** Приведенный игрок получает 50 поинтов ежедневно → бонус: 1000 + 5 = 1005 поинтов.

### 4.6. **Покупка Поинтов**

- **Пакеты:**
  - 100 поинтов за 50 рублей → 1 поинт = 0.5 рубля
  - 600 поинтов за 250 рублей → 1 поинт ≈ 0.42 рубля (с бонусом 10%)
  - 1500 поинтов за 500 рублей → 1 поинт ≈ 0.40 рубля (с бонусом 10%)

## 5. **Безопасность и Баланс Экономики**

### 5.1. **Предотвращение Мошенничества**

- **Ограничение на количество переводов:**
  - Максимум 20 переводов в день на одного игрока.

- **Автоматическое отслеживание подозрительных активностей:**
  - Используйте алгоритмы для выявления подозрительных паттернов (например, массовые переводы между одними и теми же игроками).

### 5.2. **Контроль Инфляции**

- **Комиссии и налоги:**
  - Введение комиссий за переводы и продажи поинтов помогает контролировать инфляцию.

- **Регулярное обновление наград и лимитов:**
  - Анализируйте экономику игры и корректируйте параметры (например, увеличивайте или уменьшайте ежедневные награды) в зависимости от активности игроков.

### 5.3. **Мониторинг и Аналитика**

- **Сбор данных:**
  - Отслеживайте количество поинтов в обращении, активность игроков, объем переводов и другие ключевые метрики.

- **Регулярные обновления:**
  - На основе собранных данных корректируйте экономику игры для поддержания баланса.

## 6. **Техническая Реализация**

### 6.1. **Структура Базы Данных**

- **Таблица пользователей:**
  - `user_id`: уникальный идентификатор игрока.
  - `balance`: количество поинтов.
  - `rating_points`: количество рейтинговых очков.
  - `global_rank`: текущее место в рейтинге.
  - `referrer_id`: ID пользователя, который пригласил данного игрока.
  - `is_premium`: статус премиум-подписки.
  - `last_daily_reward`: дата последнего получения награды.

- **Таблица переводов:**
  - `transfer_id`
  - `sender_id`
  - `receiver_id`
  - `amount`
  - `timestamp`

- **Таблица рефералов:**
  - `referral_id`
  - `referrer_id`
  - `referee_id`
  - `level`: уровень реферала.

- **Таблица покупок:**
  - `purchase_id`
  - `user_id`
  - `amount`
  - `currency_type` (поинты, рейтинговые очки, премиум)
  - `timestamp`

### 6.2. **Логика Бота**

1. **Регистрация и Авторизация:**
   - Новый игрок получает 100 поинтов и 100 рейтинговых очков.
   - Возможность указать реферальный код при регистрации.

2. **Передача Поинтов:**
   - Интерфейс для выбора игрока из рейтинга.
   - Проверка лимитов и комиссий.
   - Обновление балансов и рейтинговых очков.

3. **Получение Ежедневных Наград:**
   - Автоматическое начисление наград при ежедневном входе.
   - Обновление рейтинга перед начислением.

4. **Реферальная Система:**
   - Отслеживание привлеченных игроков.
   - Автоматическое начисление бонусов.

5. **Покупка и Продажа Поинтов:**
   - Интерфейс для покупки поинтов за рубли.
   - Возможность обмена поинтов на рейтинговые очки и обратно.

6. **Премиум Подписка:**
   - Управление подпиской через платежные системы.
   - Автоматическое применение бонусов для премиум-пользователей.

7. **Мониторинг и Администрирование:**
   - Панель администратора для отслеживания активности, управления пользователями и настройки событий.

## 7. **Пример Псевдокода для Основных Функций**

### 7.1. **Передача Поинтов**

```python
def transfer_points(sender_id, receiver_id, amount):
    sender = get_user(sender_id)
    receiver = get_user(receiver_id)
    
    if amount < 10 or amount > 100:
        return "Неверная сумма перевода. Минимум 10, максимум 100 поинтов."
    
    commission = amount * 0.05
    total_deduction = amount + commission
    
    if sender.balance < total_deduction:
        return "Недостаточно поинтов для перевода."
    
    sender.balance -= total_deduction
    receiver.balance += amount
    sender.rating_points += (amount / 10)
    
    save_transfer(sender_id, receiver_id, amount, commission)
    update_global_ranking()
    
    return "Перевод успешно выполнен!"
```

### 7.2. **Начисление Ежедневных Наград**

```python
def award_daily_points():
    global_ranking = get_global_ranking()
    
    for rank, user in enumerate(global_ranking, start=1):
        daily_reward = rank * 5
        if user.is_premium:
            daily_reward *= 1.4  # 40% бонус для премиум
        user.balance += daily_reward
        user.last_daily_reward = today
        # Начисление реферальных бонусов
        if user.referrer_id:
            referrer = get_user(user.referrer_id)
            referrer.balance += 1000  # базовый бонус
            referrer.balance += daily_reward * 0.10  # 10% от ежедневных наград реферала
    save_all_users()
```

### 7.3. **Покупка Поинтов**

```python
def purchase_points(user_id, amount_rub):
    packages = {
        50: 100,
        250: 600,
        500: 1500
    }
    
    if amount_rub not in packages:
        return "Неверный выбор пакета."
    
    points = packages[amount_rub]
    user = get_user(user_id)
    user.balance += points
    save_purchase(user_id, points, 'points')
    save_user(user)
    
    return f"Вы успешно купили {points} поинтов!"
```

### 7.4. **Реферальная Система**

```python
def register_user(new_user_id, referrer_id=None):
    user = create_user(new_user_id)
    user.balance = 100
    user.rating_points = 100
    
    if referrer_id and valid_referrer(referrer_id):
        user.referrer_id = referrer_id
        referrer = get_user(referrer_id)
        referrer.balance += 1000
        save_user(referrer)
    
    save_user(user)
    return user
```

## 8. **Дополнительные Рекомендации**

### 8.1. **Тестирование Экономики**

Перед запуском проведите симуляции с разными сценариями использования, чтобы выявить потенциальные проблемы, такие как инфляция или дефицит поинтов.

### 8.2. **Обратная Связь от Пользователей**

Регулярно собирайте отзывы от игроков и будьте готовы вносить изменения в экономику на основе их предложений и поведения в игре.

### 8.3. **Регулярные Обновления и События**

Постоянно добавляйте новые функции, события и награды, чтобы поддерживать интерес игроков и стимулировать их активность.

### 8.4. **Локализация и Масштабируемость**

Если планируете расширять аудиторию, обеспечьте поддержку нескольких языков и возможность масштабирования базы данных и серверной части.

## 9. **Заключение**

Разработка устойчивой экономики для мини-игры требует тщательного планирования и постоянного мониторинга. Представленные формулы и механики помогут вам создать сбалансированную и привлекательную игру для пользователей. Удачи в реализации вашего Telegram-бота!
